# POLARIS Configuration with Bayesian/Kalman Filter World Model
# This configuration uses the deterministic Bayesian world model instead of LLM-based models

framework:
  name: "POLARIS"
  version: "2.0"
  nats:
    url: "nats://localhost:4222"
    max_reconnect_attempts: 10
    reconnect_wait_sec: 2
  
  telemetry:
    batch_subject: "polaris.telemetry.events.batch"
    stream_subject: "polaris.telemetry.events.stream"
    batch_size: 50
    batch_timeout_sec: 5.0
  
  execution:
    result_subject: "polaris.execution.results"
    timeout_sec: 30

digital_twin:
  nats:
    queue_group: "digital_twin_workers"
    queue_maxsize: 2000
    batch_size: 20
    batch_timeout_sec: 2.0
    max_reconnect_attempts: 10
    reconnect_wait_sec: 2
    error_subject: "polaris.digitaltwin.errors"
    calibrate_subject: "polaris.digitaltwin.calibrate"
  
  grpc:
    address: "localhost:50051"
    port: 50051
    max_workers: 10
    # Enhanced timeout configurations
    query_timeout_sec: 20
    simulation_timeout_sec: 90
    diagnosis_timeout_sec: 45
    connection_timeout_sec: 15
    # Connection options
    max_receive_message_length: 104857600  # 100MB
    max_send_message_length: 104857600     # 100MB
    keepalive_time_ms: 30000
    keepalive_timeout_ms: 5000
    max_connection_idle_ms: 300000
  
  debugging:
    validate_interface: true
    log_level: "DEBUG"

# Bayesian/Kalman Filter World Model Configuration
world_model:
  implementation: "bayesian"
  config:
    # Prediction settings
    prediction_horizon_minutes: 120
    max_history_points: 2000
    update_interval_seconds: 30
    
    # Statistical thresholds
    correlation_threshold: 0.7
    anomaly_threshold: 2.5
    prior_confidence: 0.5
    learning_rate: 0.05
    
    # Kalman filter parameters
    process_noise: 0.01
    measurement_noise: 0.1
    initial_uncertainty: 1.0
    
    # Performance settings
    max_concurrent_operations: 10
    computation_timeout_sec: 30

# Knowledge Base Configuration
knowledge_base:
  implementation: "vector_db"
  config:
    connection_string: "postgresql://localhost:5432/polaris_kb"
    vector_dimension: 384
    similarity_threshold: 0.7
    max_results: 50

# Reasoner Configuration
reasoner:
  # LLM settings for agentic reasoning (Gemini)
  llm:
    api_key_env: "GEMINI_API_KEY"
    model: "gemini-2.0-flash"
    temperature: 0.3
    max_tokens: 8192
    timeout_sec: 30
    max_retries: 3
  
  # Digital Twin client settings
  digital_twin_client:
    type: "improved_grpc"
    query_timeout: 20.0
    simulation_timeout: 90.0
    diagnosis_timeout: 45.0
    connection_timeout: 15.0
    max_retries: 3
    circuit_breaker_enabled: true
    failure_threshold: 5
    recovery_timeout: 60.0
  
  # Tool usage settings
  max_tool_calls: 5
  tool_timeout_sec: 45

# Monitoring and Observability
monitoring:
  metrics_enabled: true
  health_check_interval_sec: 30
  performance_logging: true
  error_tracking: true
  
  # Specific to Bayesian model
  bayesian_metrics:
    track_prediction_accuracy: true
    track_correlation_discovery: true
    track_anomaly_detection: true
    accuracy_window_size: 100